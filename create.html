<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>åˆ›å»ºè®¢å• - èŠ‹å¤´é¥­ä¸“å–åº—</title>
  <style>
    body {
      font-family: "Noto Sans SC", sans-serif;
      background: #fff9f3;
      padding: 20px;
      color: #333;
    }
    h2 {
      color: #8b5e3c;
    }
    .btn {
      padding: 10px 20px;
      border: none;
      background: #a4724c;
      color: white;
      border-radius: 10px;
      cursor: pointer;
      margin: 10px 5px;
    }
    .input {
      margin: 10px 0;
      display: block;
    }
    .group {
      border: 1px solid #ddd;
      padding: 15px;
      margin: 10px 0;
      border-radius: 12px;
      background: #fff;
    }
    .output {
      margin-top: 20px;
      white-space: pre-wrap;
      background: #f4e4d4;
      padding: 15px;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <h2>ğŸ½ åˆ›å»ºè®¢å•</h2>

  <label class="input">ç”¨é¤äººæ•°ï¼š<input type="number" id="numPeople" min="1" max="20" /></label>
  <label class="input">å…±ç”¨å‡ ç¢—æ±¤ï¼š<input type="number" id="numBowls" min="1" /></label>
  <label class="input">ç™½é¥­å‡ ç¢—ï¼š<input type="number" id="riceWhite" min="0" /></label>
  <label class="input">èŠ‹å¤´é¥­å‡ ç¢—ï¼š<input type="number" id="riceTaro" min="0" /></label>
  <button class="btn" onclick="generateGroups()">ä¸‹ä¸€æ­¥</button>

  <form id="orderForm" onsubmit="submitOrder(event)"></form>

  <script>
    const ingredients = [
      { name: "çŒªè‚", emoji: "ğŸ¥•" },
      { name: "çŒªè…°", emoji: "ğŸ¤¢" },
      { name: "çŒªè‚ ", emoji: "ğŸ¥½" },
      { name: "çŒªè‚š", emoji: "ğŸ¤®" },
      { name: "çŒªèˆŒå¤´", emoji: "ğŸ§ " },
      { name: "ç˜¦è‚‰", emoji: "ğŸ¥©" },
      { name: "è‚¥è‚‰", emoji: "ğŸ¥ " },
      { name: "èœ", emoji: "ğŸŒ¿" },
      { name: "è‚‰ä¸¸", emoji: "ğŸ¥" },
      { name: "çŒªå¿ƒ", emoji: "â¤ï¸" }
    ];

    function generateGroups() {
      const numPeople = parseInt(document.getElementById("numPeople").value);
      const numBowls = parseInt(document.getElementById("numBowls").value);
      const form = document.getElementById("orderForm");
      form.innerHTML = "";

      for (let i = 0; i < numBowls; i++) {
        const group = document.createElement("div");
        group.className = "group";
        group.innerHTML = `<h3>ç¬¬ ${i + 1} ç¢— - åˆ†ç»™å‡ äººï¼š</h3>`;

        const select = document.createElement("input");
        select.type = "number";
        select.name = `groupPeople${i}`;
        select.value = 1;
        select.min = 1;
        select.max = numPeople;
        group.appendChild(select);

        const ingredientsText = document.createElement("div");
        ingredientsText.innerHTML = `<p>ä»¥ä¸‹é£Ÿæä¸åƒï¼š</p>`;
        ingredients.forEach(ing => {
          const label = document.createElement("label");
          label.innerHTML = `<input type="checkbox" name="group${i}_no_${ing.name}" /> ${ing.emoji} ${ing.name}`;
          ingredientsText.appendChild(label);
        });
        group.appendChild(ingredientsText);

        form.appendChild(group);
      }

      const submitBtn = document.createElement("button");
      submitBtn.textContent = "æäº¤è®¢å•";
      submitBtn.className = "btn";
      submitBtn.type = "submit";
      form.appendChild(submitBtn);
    }

    function submitOrder(e) {
      e.preventDefault();
      const date = new Date().toLocaleDateString();
      const orderNum = parseInt(localStorage.getItem("orderNum") || "0") + 1;
      localStorage.setItem("orderNum", orderNum > 50 ? 1 : orderNum);
      const riceWhite = document.getElementById("riceWhite").value;
      const riceTaro = document.getElementById("riceTaro").value;
      const formData = new FormData(document.getElementById("orderForm"));
      let text = `\u2705 è®¢å•ç¼–å·ï¼š${orderNum}\næ—¥æœŸï¼š${date}\n\nç™½é¥­ï¼š${riceWhite} ç¢—\nèŠ‹å¤´é¥­ï¼š${riceTaro} ç¢—\n`;
      for (let [key, val] of formData.entries()) {
        if (val === "on") {
          const [group, , name] = key.split("_");
          text += `ç¬¬ ${parseInt(group.replace("group", "")) + 1} ç¢—ä¸åƒï¼š${name}\n`;
        }
      }
      const orders = JSON.parse(localStorage.getItem("orders") || "[]");
      orders.push({ id: orderNum, date, content: text });
      localStorage.setItem("orders", JSON.stringify(orders));
      alert("è®¢å•å·²æäº¤ï¼");
      window.location.href = "orders.html";
    }
  </script>
</body>
</html>
