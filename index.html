<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>大山脚芋头饭专卖店 点餐系统</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f9f9f9; }
    h2 { color: #5a2d0c; }
    .person-block { border: 1px solid #ccc; padding: 15px; margin-bottom: 20px; background: #fff; border-radius: 5px; }
    label { display: block; margin-top: 5px; }
    textarea { width: 100%; height: 50px; margin-top: 5px; }
    .output { white-space: pre-wrap; background: #eee; padding: 15px; border-radius: 5px; margin-top: 20px; }
    button { margin-top: 20px; padding: 10px 15px; }
    .config { margin-bottom: 20px; }
    input[type="number"] { width: 60px; }
  </style>
</head>
<body>

<h2>大山脚芋头饭专卖店</h2>

<div class="config">
  <label for="numPeople">请输入用餐人数：</label>
  <input type="number" id="numPeople" min="1" max="20" value="1" />

  <p><strong>请选择汤的分配方式：</strong></p>
  <label><input type="radio" name="soupOption" value="each" checked> 每人一碗</label>
  <label><input type="radio" name="soupOption" value="shared"> 共用一碗（每碗人数）：
    <input type="number" id="shareCount" min="1" max="20" value="5" />
  </label>

  <br />
  <button onclick="generateForm()">下一步</button>
</div>

<div id="formArea"></div>
<div id="summaryArea"></div>

<script>
  const ingredients = ["猪肝", "猪腰", "猪肠", "猪肚", "猪舌头", "瘦肉", "肥肉", "菜", "肉丸"];

  function generateForm() {
    const num = parseInt(document.getElementById("numPeople").value);
    const area = document.getElementById("formArea");
    const summaryArea = document.getElementById("summaryArea");
    area.innerHTML = '';
    summaryArea.innerHTML = '';

    for (let i = 0; i < num; i++) {
      const div = document.createElement("div");
      div.className = "person-block";
      div.innerHTML = `<h3>顾客 ${i + 1}</h3>`;

      div.innerHTML += `<strong>不吃的材料：</strong><br>`;
      ingredients.forEach(item => {
        div.innerHTML += `<label><input type="checkbox" name="p${i}_no" value="${item}"> ${item}</label>`;
      });

      div.innerHTML += `<br><strong>饭类：</strong><br>
        <label><input type="radio" name="p${i}_rice" value="白饭" checked> 白饭</label>
        <label><input type="radio" name="p${i}_rice" value="芋头饭"> 芋头饭</label>`;

      div.innerHTML += `<br><strong>饭量：</strong><br>
        <label><input type="radio" name="p${i}_portion" value="正常饭量" checked> 正常饭量</label>
        <label><input type="radio" name="p${i}_portion" value="少饭"> 少饭</label>
        <label><input type="radio" name="p${i}_portion" value="加饭"> 加饭</label>`;

      div.innerHTML += `<br><label>备注：</label><textarea name="p${i}_remark"></textarea>`;

      area.appendChild(div);
    }

    const btn = document.createElement("button");
    btn.textContent = "生成点餐结果";
    btn.onclick = generateSummary;
    area.appendChild(btn);
  }

  function generateSummary() {
    const num = parseInt(document.getElementById("numPeople").value);
    const soupOption = document.querySelector('input[name="soupOption"]:checked').value;
    const shareCount = parseInt(document.getElementById("shareCount").value);
    const summary = [];

    summary.push(`大山脚芋头饭专卖店 - 今日订单\n`);
    summary.push(`👥 用餐人数：${num}人\n`);

    for (let i = 0; i < num; i++) {
      const noItems = Array.from(document.querySelectorAll(`input[name="p${i}_no"]:checked`)).map(cb => cb.value);
      const rice = document.querySelector(`input[name="p${i}_rice"]:checked`).value;
      const portion = document.querySelector(`input[name="p${i}_portion"]:checked`).value;
      const remark = document.querySelector(`textarea[name="p${i}_remark"]`).value.trim();

      summary.push(`👤 顾客${i + 1}：`);
      summary.push(`  不吃：${noItems.length ? noItems.join("、") : "无特别忌口"}`);
      summary.push(`  饭类：${rice}（${portion}）`);
      summary.push(`  备注：${remark || "无"}`);
      summary.push('');
    }

    // 汤碗安排
    summary.push(`🍲 汤碗安排：`);
    if (soupOption === 'each') {
      for (let i = 0; i < num; i++) {
        summary.push(`- 顾客 ${i + 1}：个人一碗`);
      }
      summary.push(`✅ 共需准备 ${num} 碗汤`);
    } else {
      let count = 0;
      for (let i = 0; i < num; i += shareCount) {
        const group = [];
        for (let j = i; j < i + shareCount && j < num; j++) {
          group.push(`顾客 ${j + 1}`);
        }
        summary.push(`- ${group.join("、")}：共用一碗`);
        count++;
      }
      summary.push(`✅ 共需准备 ${count} 碗汤`);
    }

    document.getElementById("summaryArea").innerHTML = `<div class="output">${summary.join('\n')}</div>`;
  }
</script>

</body>
</html>

