<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>大山脚芋头饭专卖店 - 简洁点餐系统</title>
  <style>
    body { font-family: sans-serif; background: #f8f8f8; padding: 20px; }
    h2 { color: #5a2d0c; }
    .section { background: #fff; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
    label { display: block; margin: 8px 0 4px; }
    input[type="number"], textarea { width: 100%; padding: 5px; font-size: 16px; }
    button { padding: 10px 15px; font-size: 16px; margin-top: 15px; }
    .output { white-space: pre-wrap; background: #eee; padding: 15px; border-radius: 5px; margin-top: 20px; }
  </style>
</head>
<body>

  <h2>🍠 大山脚芋头饭专卖店 - 点餐系统</h2>

  <div class="section">
    <label for="numPeople">👥 用餐人数：</label>
    <input type="number" id="numPeople" min="1" max="50" value="1">

    <label for="numSoups">🥣 汤共用几碗：</label>
    <input type="number" id="numSoups" min="1" max="10" value="1">

    <div id="soupArea"></div>

    <label for="riceWhite">🍚 白饭几碗：</label>
    <input type="number" id="riceWhite" min="0" value="0">

    <label for="riceTaro">🍠 芋头饭几碗：</label>
    <input type="number" id="riceTaro" min="0" value="0">

    <label for="remark">📝 整单备注：</label>
    <textarea id="remark" placeholder="如：不要辣、另外打包一碗饭等..."></textarea>

    <button onclick="generateSummary()">✅ 生成订单</button>
  </div>

  <div class="output" id="summaryArea"></div>

  <script>
    const ingredients = ["猪肝", "猪腰", "猪肠", "猪肚", "猪舌头", "瘦肉", "肥肉", "菜", "肉丸"];
    let orderNumber = parseInt(localStorage.getItem("orderNumber") || "0");

    document.getElementById("numSoups").addEventListener("input", generateSoupInputs);

    function generateSoupInputs() {
      const soupArea = document.getElementById("soupArea");
      const count = parseInt(document.getElementById("numSoups").value);
      soupArea.innerHTML = '';

      for (let i = 0; i < count; i++) {
        const div = document.createElement("div");
        div.className = "section";
        div.innerHTML = `<strong>🥣 第 ${i + 1} 碗汤</strong><br>
          <label>👤 共用人数：</label>
          <input type="number" min="1" max="20" id="soupPeople_${i}" value="1">
          <label>❌ 忌口材料：</label>` +
          ingredients.map(ing => `<label><input type="checkbox" name="soupNo_${i}" value="${ing}"> ${ing}</label>`).join('');
        soupArea.appendChild(div);
      }
    }

    generateSoupInputs();

    function generateSummary() {
      const numPeople = parseInt(document.getElementById("numPeople").value);
      const numSoups = parseInt(document.getElementById("numSoups").value);
      const riceWhite = parseInt(document.getElementById("riceWhite").value);
      const riceTaro = parseInt(document.getElementById("riceTaro").value);
      const remark = document.getElementById("remark").value.trim();
      const today = new Date().toISOString().split('T')[0];

      // 订单编号轮询 1~50
      orderNumber = (orderNumber % 50) + 1;
      localStorage.setItem("orderNumber", orderNumber);

      let output = `📅 日期：${today}\n🧾 订单编号：${orderNumber}\n`;
      output += `👥 用餐人数：${numPeople}人\n\n🥣 汤类分配：\n`;

      for (let i = 0; i < numSoups; i++) {
        const soupCount = document.getElementById(`soupPeople_${i}`).value;
        const noItems = Array.from(document.querySelectorAll(`input[name="soupNo_${i}"]:checked`)).map(cb => cb.value);
        output += `  - 第 ${i + 1} 碗：${soupCount}人共用`;
        output += noItems.length ? `（不吃：${noItems.join("、")}）` : '（无忌口）';
        output += '\n';
      }

      output += `\n🍚 饭类：白饭 ${riceWhite} 碗，芋头饭 ${riceTaro} 碗\n`;
      output += `\n📝 备注：${remark || "无"}\n`;

      document.getElementById("summaryArea").textContent = output;
    }
  </script>

</body>
</html>
